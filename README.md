CornerstoneXnat
================

[CornerstoneXnat](http://github.com/tomdoel/CornerstoneXnat) is a simple, prototype DICOM image viewer for scans stored on an XNAT server. The viewer code is HTML5/Javascript and should run in any modern browser. No server-side modifications are required other than serving the static webpages on the same server as the XNAT installation.

CornerstoneXnat is based on [cornerstoneDemo](http://github.com/chafey/cornerstoneDemo) by Chris Hafley.

cornerstoneDemo uses cornerstone Image Loaders to fetch Dicom or other images from the web; CornerstoneXnat adapts these Image Loaders to use the XNAT REST API to fetch the images and list of subjects and scans.

Please note this a proof-of-concept prototype and is not intended to be complete or robust in any way.


CornerstoneXnat is by Tom Doel. It is adapted from [cornerstone](http://github.com/chafey/cornerstone)  and [cornerstoneDemo](http://github.com/chafey/cornerstoneDemo) by Chris Hafley.

Install and run
================

Installation is similar to [cornerstoneDemo](http://github.com/chafey/cornerstoneDemo).
However, note that the generated static content must be served from the same server that hosts your XNAT installation; see below.

Installation

- Clone the repo and switch to its directory

- Install dependencies via [Bower](http://bower.io/):

> bower install

The output (including the css, lib, js and template folders) should be copied to the server that is hosting your XNAT installation, and should be served as static web pages.
An easy way to do this if you are using tomcat is to serve static content from a folder by adding a one-line `Context` element to your `server.xml` - [see here for example](http://www.moreofless.co.uk/static-content-web-pages-images-tomcat-outside-war/)

If your XNAT projects are not public then you of course will need to log in to your XNAT server to authenticate your credentials and store a session cookie. Because your browser will send the session cookie automatically with the REST calls, you just log in as normal on the XNAT webpage and you do not need to log in again (unless your session expires).

Once logged in you can navigate to your CornerstoneXnat static site and enter your XNAT site's URL. Then you can view a list of subjects across all your accessible projects. Click on a subject to show available scans.

You can also add a parameter `?url=http://yoursite` when navigating to the CornerstoneXnat site; this specified the URL of the XNAT site so you don't need to type it in again. You could add a button or link directly from your XNAT webpages and use this parameter.


Note: cross-origin support
==========================

The static content generated by CornerstoreXnat must be served from the same server that hosts your XNAT installation. This is not a limitation of CornerstoneXnat; it is a security feature of your browser. Your browser will automatically reject cross-origin secure REST calls to the XNAT server (i.e. calls from code which originated from a different server). This is a security measure to protect against malicious websites using your cookies to access secure content. If you want to serve CornerstoneXnat from a different server than your XNAT installation, you will have to configure CORS on your XNAT tomcat server to allow cross-origin calls from the server hosting your static CornerstoneXnat code. You will also need to configure your XNAT spring security accordingly.

